<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
  <title>Dungeon Quest – FINAL</title>
  <style>
    :root { --bg:#0e0f13; --fg:#eef0f6; --muted:#a1a6b3; --line:#1f2130; --accent:#7bd88f; --warn:#ffb86c; --danger:#ff6b81; }
    * { box-sizing: border-box; }
    html, body { height:100%; margin:0; background:var(--bg); color:var(--fg); font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', 'Noto Sans', sans-serif; }
    #wrap { height:100%; display:grid; grid-template-rows:auto 1fr auto; }
    header, footer { display:flex; align-items:center; justify-content:space-between; padding:10px 14px; border-bottom:1px solid var(--line); }
    footer { border-top:1px solid var(--line); border-bottom:none; gap:12px; flex-wrap:wrap; }
    h1 { margin:0; font-size:18px; }
    .pill { border:1px solid var(--line); border-radius:999px; padding:3px 8px; color:var(--muted); font-size:12px; }
    #game { display:block; width:100%; height:calc(100vh - 110px); image-rendering: pixelated; background:#090a0f; touch-action:none; }
    .btn { background:#151827; border:1px solid var(--line); color:var(--fg); border-radius:12px; padding:8px 12px; cursor:pointer; }
    .btn:hover { border-color:#2a2d3f; }
    .hud { position:fixed; left:10px; top:60px; background:rgba(0,0,0,.35); padding:8px 10px; border-radius:12px; font: 14px/1.2 monospace; pointer-events:none; }
    .overlay { position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,.6); padding:16px; }
    .panel { background:#121427; border:1px solid var(--line); border-radius:16px; padding:20px; width:min(92vw,780px); }
    .panel h2 { margin:0 0 6px 0; }
    .grid { display:grid; gap:8px; grid-template-columns: repeat(auto-fit, minmax(140px,1fr)); }
    kbd { background:#171a2a; border:1px solid var(--line); border-radius:6px; padding:2px 6px; }
    /* Mobile controls */
    #touch { position:fixed; inset:0; pointer-events:none; }
    .stick { position:absolute; left:14px; bottom:90px; width:120px; height:120px; border-radius:50%; background:rgba(255,255,255,.05); border:1px solid var(--line); pointer-events:auto; touch-action:none; }
    .knob { position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); width:56px; height:56px; border-radius:50%; background:rgba(255,255,255,.1); border:1px solid var(--line); }
    .pad { position:absolute; right:14px; bottom:90px; display:flex; gap:12px; pointer-events:auto; }
    .circle { width:64px; height:64px; border-radius:50%; background:rgba(255,255,255,.06); border:1px solid var(--line); display:grid; place-items:center; }
    .hotbar { position:fixed; left:50%; transform:translateX(-50%); bottom:16px; display:flex; gap:8px; }
    .slot { width:52px; height:52px; border-radius:12px; background:#14172a; border:1px solid var(--line); display:grid; place-items:center; font:12px monospace; }
  </style>
</head>
<body>
  <div id="wrap">
    <header>
      <div style="display:flex; align-items:center; gap:10px;">
        <h1>Dungeon Quest — FINAL</h1>
        <span class="pill">Top-Down</span>
        <span class="pill">12 уровней</span>
        <span class="pill">Save/Load</span>
      </div>
      <div style="display:flex; gap:8px;">
        <button id="btn-help" class="btn">Справка</button>
        <button id="btn-settings" class="btn">Настройки</button>
        <button id="btn-restart" class="btn">Рестарт</button>
        <button id="btn-pause" class="btn">Пауза</button>
      </div>
    </header>

    <canvas id="game"></canvas>

    <footer>
      <div>© 2025 — MIT</div>
      <div style="display:flex; gap:8px; flex-wrap:wrap;">
        <button id="btn-save" class="btn">Сохранить</button>
        <button id="btn-load" class="btn">Загрузить</button>
        <button id="btn-reset" class="btn">Сброс прогресса</button>
      </div>
    </footer>
  </div>

  <div id="hud" class="hud"></div>

  <div id="overlay" class="overlay">
    <div class="panel">
      <h2 id="ov-title">Dungeon Quest FINAL</h2>
      <p id="ov-body">Соберите ресурсы, найдите ключ, откройте дверь и пройдите все уровни. Есть инвентарь, боёвка, перекат, враги и сундуки.</p>
      <div class="grid">
        <div><b>Управление:</b><br/><kbd>WASD/Стрелки</kbd> — движение<br/><kbd>Space</kbd> — перекат<br/><kbd>J</kbd> — атака<br/><kbd>1..3</kbd> — слоты</div>
        <div><b>Системы:</b><br/>AI врагов (патруль/преследование/маги), лут, сохранение, мобильные кнопки</div>
      </div>
      <p style="color:var(--muted)">Совет: в настройках можно включить/выключить звук и вибрацию.</p>
      <div style="display:flex; gap:8px; flex-wrap:wrap;">
        <button id="ov-start" class="btn">Старт</button>
        <button id="ov-close" class="btn">Закрыть</button>
      </div>
    </div>
  </div>

  <div id="touch">
    <div class="stick" id="stick"><div class="knob" id="knob"></div></div>
    <div class="pad">
      <div class="circle" id="btn-attack">J</div>
      <div class="circle" id="btn-roll">⤵︎</div>
      <div class="circle" id="btn-pause2">⏸︎</div>
    </div>
    <div class="hotbar" id="hotbar">
      <div class="slot" data-slot="1">1</div>
      <div class="slot" data-slot="2">2</div>
      <div class="slot" data-slot="3">3</div>
    </div>
  </div>

  <script type="module" src="./src/main.js"></script>
</body>
</html>
